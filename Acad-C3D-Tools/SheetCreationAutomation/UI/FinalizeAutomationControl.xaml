<UserControl x:Class="SheetCreationAutomation.UI.FinalizeAutomationControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             Background="{DynamicResource BackgroundBrush}">
    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="Theme.xaml" />
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </UserControl.Resources>

    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Margin="16">
            <TextBlock Text="Sheet Finalization Automation"
                       FontSize="20"
                       FontWeight="SemiBold"
                       Margin="0,0,0,2" />
            <TextBlock Text="Civil 3D native automation  Â·  Step 3"
                       Style="{StaticResource LabelStyle}"
                       Margin="0,0,0,16" />

            <GroupBox Header="Workflow">
                <TextBlock TextWrapping="Wrap" LineHeight="22"
                           Foreground="{StaticResource ForegroundMutedBrush}">
                    <Run Foreground="{StaticResource AccentBrush}" Text="1."/><Run Text=" Open Civil 3D."/><LineBreak/>
                    <Run Foreground="{StaticResource AccentBrush}" Text="2."/><Run Text=" NETLOAD required tools and unload xrefs in batch for sheet folder."/><LineBreak/>
                    <Run Foreground="{StaticResource AccentBrush}" Text="3."/><Run Text=" Select the sheets folder below."/><LineBreak/>
                    <Run Foreground="{StaticResource AccentBrush}" Text="4."/><Run Text=" Build/edit fileList.txt using *_SHT.dwg files."/><LineBreak/>
                    <Run Foreground="{StaticResource AccentBrush}" Text="5."/><Run Text=" Provide project and phase names from Stier.csv."/>
                </TextBlock>
            </GroupBox>

            <GroupBox Header="Sheets Folder">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                    <Button Content="Select folder"
                            Command="{Binding BrowseFolderCommand}"
                            Padding="12,6" />
                    <TextBox Grid.Column="1"
                             Text="{Binding SheetsFolderPath, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                             IsReadOnly="True"
                             Margin="8,0,0,0" />
                </Grid>
            </GroupBox>

            <GroupBox Header="fileList.txt">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                    <Button Content="Create file list"
                            Command="{Binding CreateFileListCommand}"
                            Padding="12,6" />
                    <TextBox Grid.Column="1"
                             Text="{Binding FileListStatus, Mode=OneWay}"
                             IsReadOnly="True"
                             Cursor="Hand"
                             Margin="8,0,0,0"
                             ToolTip="Click to open in Notepad">
                        <TextBox.InputBindings>
                            <MouseBinding MouseAction="LeftClick"
                                          Command="{Binding OpenFileListCommand}" />
                        </TextBox.InputBindings>
                    </TextBox>
                </Grid>
            </GroupBox>

            <GroupBox Header="Project name">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="Input project name:"
                               VerticalAlignment="Center"
                               Foreground="{StaticResource ForegroundMutedBrush}"
                               Margin="0,0,12,0" />
                    <TextBox Text="{Binding ProjectName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                             Width="220"
                             TextAlignment="Right" />
                </StackPanel>
            </GroupBox>

            <GroupBox Header="Phase (etape) name">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="Input phase (etape) name:"
                               VerticalAlignment="Center"
                               Foreground="{StaticResource ForegroundMutedBrush}"
                               Margin="0,0,12,0" />
                    <TextBox Text="{Binding EtapeName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                             Width="220"
                             TextAlignment="Right" />
                </StackPanel>
            </GroupBox>

            <TextBlock TextWrapping="Wrap"
                       Foreground="{StaticResource WarningBrush}"
                       Margin="0,0,0,8">
                <Run Text="After finalization, run XREFSRELOADALLBATCH on the same sheet folder." />
            </TextBlock>

            <TextBlock Text="{Binding LastStatus}"
                       TextWrapping="Wrap"
                       Foreground="{StaticResource WarningBrush}"
                       Margin="0,4,0,12" />

            <Button Style="{StaticResource PrimaryButton}"
                    Content="START SHEET FINALIZATION SCRIPT"
                    Padding="20,16"
                    FontSize="14"
                    Margin="0,8,0,20"
                    Command="{Binding StartFinalizeScriptCommand}" />
        </StackPanel>
    </ScrollViewer>
</UserControl>
