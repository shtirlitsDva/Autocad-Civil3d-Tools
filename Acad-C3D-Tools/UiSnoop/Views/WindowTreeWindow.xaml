<Window x:Class="UiSnoop.Views.WindowTreeWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="clr-namespace:UiSnoop.ViewModels"
        Title="Window Tree Inspector"
        Height="650"
        Width="860"
        MinHeight="400"
        MinWidth="500"
        Background="{DynamicResource BackgroundBrush}"
        Foreground="{DynamicResource TextBrush}">
    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <Border Grid.Row="0"
                Padding="10"
                CornerRadius="6"
                Background="{DynamicResource SurfaceBrush}"
                BorderBrush="{DynamicResource BorderBrush}"
                BorderThickness="1">
            <WrapPanel VerticalAlignment="Center">
                <Button Content="Refresh" Command="{Binding RefreshCommand}" Margin="0,0,8,0" />
                <Button Content="Copy Tree" Command="{Binding CopyTreeCommand}" Margin="0,0,12,0" />
                <TextBlock VerticalAlignment="Center"
                           Foreground="{DynamicResource MutedTextBrush}"
                           Text="{Binding StatusText}" />
            </WrapPanel>
        </Border>

        <TreeView Grid.Row="1"
                  Margin="0,10,0,0"
                  ItemsSource="{Binding RootNodes}"
                  PreviewMouseMove="OnTreePreviewMouseMove"
                  MouseLeave="OnTreeMouseLeave"
                  VirtualizingStackPanel.IsVirtualizing="True"
                  VirtualizingStackPanel.VirtualizationMode="Recycling">
            <TreeView.ItemTemplate>
                <HierarchicalDataTemplate DataType="{x:Type vm:WindowNode}"
                                          ItemsSource="{Binding Children}">
                    <StackPanel Orientation="Vertical" Margin="2">
                        <TextBlock Text="{Binding HeaderText}"
                                   FontFamily="Consolas"
                                   FontSize="13"
                                   Foreground="{DynamicResource TextBrush}" />
                        <TextBlock Text="{Binding DetailText}"
                                   FontFamily="Consolas"
                                   FontSize="11"
                                   Foreground="{DynamicResource MutedTextBrush}"
                                   Margin="0,1,0,0" />
                    </StackPanel>
                </HierarchicalDataTemplate>
            </TreeView.ItemTemplate>
            <TreeView.ItemContainerStyle>
                <Style TargetType="{x:Type TreeViewItem}" BasedOn="{StaticResource {x:Type TreeViewItem}}">
                    <Setter Property="IsExpanded" Value="True" />
                </Style>
            </TreeView.ItemContainerStyle>
        </TreeView>
    </Grid>
</Window>
